<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Sleep Cycle Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Your existing CSS styles here */
        :root {
            --primary-color: #4361ee;
            --secondary-color: #7209b7;
            /* ... rest of your CSS variables ... */
        }
        /* ... rest of your CSS ... */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-moon"></i> Advanced Sleep Cycle Calculator</h1>
            <p>Find the optimal time to wake up or go to bed based on your sleep cycles for maximum energy and well-being</p>
        </div>

        <div class="card">
            <div class="toggle-container">
                <label for="dark-mode-toggle">Dark Mode</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="calc-tabs">
                <div class="calc-tab active" data-tab="bedtime"><i class="fas fa-alarm-clock"></i> I want to wake up at...</div>
                <div class="calc-tab" data-tab="wakeup"><i class="fas fa-bed"></i> I'm going to bed at...</div>
                <div class="calc-tab" data-tab="sleep-now"><i class="fas fa-stopwatch"></i> I want to sleep now</div>
                <div class="calc-tab" data-tab="age"><i class="fas fa-child"></i> Sleep by age</div>
                <div class="calc-tab" data-tab="quality"><i class="fas fa-star"></i> Sleep quality</div>
            </div>

            <!-- Bedtime Calculator -->
            <div class="calc-content active" id="bedtime-calc">
                <div class="form-group">
                    <label><i class="fas fa-clock"></i> Select your wake-up time:</label>
                    <div class="time-input">
                        <select id="bedtime-hour">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8" selected>8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                        <select id="bedtime-minute">
                            <option value="00" selected>00</option>
                            <option value="05">05</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="25">25</option>
                            <option value="30">30</option>
                            <option value="35">35</option>
                            <option value="40">40</option>
                            <option value="45">45</option>
                            <option value="50">50</option>
                            <option value="55">55</option>
                        </select>
                        <select id="bedtime-ampm">
                            <option value="AM" selected>AM</option>
                            <option value="PM">PM</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-hourglass-half"></i> Time to fall asleep:</label>
                    <div class="time-input">
                        <select id="fall-asleep-time">
                            <option value="10">10 minutes</option>
                            <option value="15" selected>15 minutes</option>
                            <option value="20">20 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60">60 minutes</option>
                        </select>
                    </div>
                </div>

                <button id="calc-bedtime"><i class="fas fa-calculator"></i> Calculate Bedtime</button>

                <div class="results" id="bedtime-results">
                    <h3><i class="fas fa-bed"></i> You should go to bed at one of these times:</h3>
                    <p>Based on the 90-minute sleep cycle and your selected wake-up time, here are your optimal bedtimes to avoid waking up during deep sleep:</p>
                    <div class="time-list" id="bedtime-list"></div>
                </div>
            </div>

            <!-- Wake-up Time Calculator -->
            <div class="calc-content" id="wakeup-calc">
                <div class="form-group">
                    <label><i class="fas fa-bed"></i> Select your bedtime:</label>
                    <div class="time-input">
                        <select id="wakeup-hour">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12" selected>12</option>
                        </select>
                        <select id="wakeup-minute">
                            <option value="00" selected>00</option>
                            <option value="05">05</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="25">25</option>
                            <option value="30">30</option>
                            <option value="35">35</option>
                            <option value="40">40</option>
                            <option value="45">45</option>
                            <option value="50">50</option>
                            <option value="55">55</option>
                        </select>
                        <select id="wakeup-ampm">
                            <option value="AM">AM</option>
                            <option value="PM" selected>PM</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-hourglass-half"></i> Time to fall asleep:</label>
                    <div class="time-input">
                        <select id="fall-asleep-time-wake">
                            <option value="10">10 minutes</option>
                            <option value="15" selected>15 minutes</option>
                            <option value="20">20 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60">60 minutes</option>
                        </select>
                    </div>
                </div>

                <button id="calc-wakeup"><i class="fas fa-calculator"></i> Calculate Wake-up Time</button>

                <div class="results" id="wakeup-results">
                    <h3><i class="fas fa-clock"></i> You should wake up at one of these times:</h3>
                    <p>Based on the 90-minute sleep cycle and your selected bedtime, here are your optimal wake-up times to feel refreshed:</p>
                    <div class="time-list" id="wakeup-list"></div>
                </div>
            </div>

            <!-- Sleep Now Calculator -->
            <div class="calc-content" id="sleep-now-calc">
                <div class="form-group">
                    <label><i class="fas fa-hourglass-half"></i> Time to fall asleep:</label>
                    <div class="time-input">
                        <select id="fall-asleep-time-now">
                            <option value="10">10 minutes</option>
                            <option value="15" selected>15 minutes</option>
                            <option value="20">20 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60">60 minutes</option>
                        </select>
                    </div>
                </div>

                <button id="calc-sleep-now" class="sleep-now-btn"><i class="fas fa-moon"></i> Calculate Sleep Now Times</button>

                <div class="results" id="sleep-now-results">
                    <h3><i class="fas fa-clock"></i> You should wake up at one of these times:</h3>
                    <p>Based on the current time, here are your optimal wake-up times:</p>
                    <div class="time-list" id="sleep-now-list"></div>
                </div>
            </div>

            <!-- Age Recommendations -->
            <div class="calc-content" id="age-calc">
                <div class="age-recommendations" id="age-recommendations"></div>
            </div>

            <!-- Sleep Quality Assessment -->
            <div class="calc-content" id="quality-calc">
                <div class="sleep-quality-section">
                    <h3><i class="fas fa-star"></i> Sleep Quality Assessment</h3>
                    <p>Answer these questions to evaluate your sleep quality:</p>
                    
                    <div class="quality-questions">
                        <div class="quality-question">
                            <p>1. How long does it usually take you to fall asleep?</p>
                            <div class="quality-options">
                                <div class="quality-option" data-value="5">Less than 15 min</div>
                                <div class="quality-option" data-value="4">15-30 min</div>
                                <div class="quality-option" data-value="3">30-60 min</div>
                                <div class="quality-option" data-value="1">More than 60 min</div>
                            </div>
                        </div>
                        
                        <div class="quality-question">
                            <p>2. How often do you wake up during the night?</p>
                            <div class="quality-options">
                                <div class="quality-option" data-value="5">Never</div>
                                <div class="quality-option" data-value="4">Once</div>
                                <div class="quality-option" data-value="3">2-3 times</div>
                                <div class="quality-option" data-value="1">More than 3 times</div>
                            </div>
                        </div>
                        
                        <div class="quality-question">
                            <p>3. How rested do you feel in the morning?</p>
                            <div class="quality-options">
                                <div class="quality-option" data-value="5">Very rested</div>
                                <div class="quality-option" data-value="4">Somewhat rested</div>
                                <div class="quality-option" data-value="2">A little tired</div>
                                <div class="quality-option" data-value="1">Very tired</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="quality-result">
                        <h4>Your Sleep Quality Score</h4>
                        <div class="quality-score">0/15</div>
                        <div class="quality-recommendations">
                            <h5>Recommendations:</h5>
                            <ul>
                                <li>Maintain consistent sleep schedule</li>
                                <li>Avoid caffeine before bedtime</li>
                                <li>Create a relaxing bedtime routine</li>
                                <li>Keep your bedroom dark and cool</li>
                                <li>Limit screen time before bed</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Tab Switching Logic
        document.querySelectorAll('.calc-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.dataset.tab;
                document.querySelectorAll('.calc-tab, .calc-content').forEach(el => {
                    el.classList.remove('active');
                });
                tab.classList.add('active');
                document.getElementById(`${targetTab}-calc`).classList.add('active');
            });
        });

        // Dark Mode Toggle
        document.getElementById('dark-mode-toggle').addEventListener('change', (e) => {
            document.body.classList.toggle('dark-mode', e.target.checked);
        });

        // Time Calculation Functions
        function parseTime(hour, minute, ampm) {
            let hours = parseInt(hour);
            if (ampm === 'PM' && hours !== 12) hours += 12;
            if (ampm === 'AM' && hours === 12) hours = 0;
            return hours * 60 + parseInt(minute);
        }

        function formatTime(minutes) {
            // Handle negative times (crossing midnight)
            if (minutes < 0) minutes += 1440; // Add 24 hours
            minutes = minutes % 1440; // Ensure within 24-hour range
            
            const hrs = Math.floor(minutes / 60) % 24;
            const mins = minutes % 60;
            const ampm = hrs >= 12 ? 'PM' : 'AM';
            const formattedHrs = hrs % 12 || 12;
            return `${formattedHrs}:${mins.toString().padStart(2, '0')} ${ampm}`;
        }

        function calculateCycles(baseTime, fallAsleep, isBedtimeCalc) {
            const cycleDuration = 90; // minutes per sleep cycle
            const totalFallAsleep = parseInt(fallAsleep);
            const results = [];
            
            for (let cycles = 6; cycles >= 4; cycles--) {
                const totalMinutes = (cycles * cycleDuration) + totalFallAsleep;
                const targetTime = isBedtimeCalc ? 
                    baseTime - totalMinutes : 
                    baseTime + totalMinutes;
                    
                results.push({
                    time: formatTime(targetTime),
                    cycles: cycles,
                    quality: cycles >= 6 ? 'excellent' : cycles >= 5 ? 'good' : 'fair'
                });
            }
            return results;
        }

        // Bedtime Calculation
        document.getElementById('calc-bedtime').addEventListener('click', () => {
            const hour = document.getElementById('bedtime-hour').value;
            const minute = document.getElementById('bedtime-minute').value;
            const ampm = document.getElementById('bedtime-ampm').value;
            const fallAsleep = document.getElementById('fall-asleep-time').value;
            
            const wakeTime = parseTime(hour, minute, ampm);
            const results = calculateCycles(wakeTime, fallAsleep, true);
            
            displayResults(results, '#bedtime-list');
            document.getElementById('bedtime-results').style.display = 'block';
        });

        // Wake-up Time Calculation
        document.getElementById('calc-wakeup').addEventListener('click', () => {
            const hour = document.getElementById('wakeup-hour').value;
            const minute = document.getElementById('wakeup-minute').value;
            const ampm = document.getElementById('wakeup-ampm').value;
            const fallAsleep = document.getElementById('fall-asleep-time-wake').value;
            
            const bedTime = parseTime(hour, minute, ampm);
            const results = calculateCycles(bedTime, fallAsleep, false);
            
            displayResults(results, '#wakeup-list');
            document.getElementById('wakeup-results').style.display = 'block';
        });

        // Sleep Now Calculation
        document.getElementById('calc-sleep-now').addEventListener('click', () => {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            const fallAsleep = document.getElementById('fall-asleep-time-now').value;
            const results = calculateCycles(currentMinutes, fallAsleep, false);
            
            displayResults(results, '#sleep-now-list');
            document.getElementById('sleep-now-results').style.display = 'block';
        });

        // Display Results
        function displayResults(results, containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            
            container.innerHTML = '';
            
            results.forEach(res => {
                const qualityIcon = {
                    excellent: '<i class="fas fa-star quality-indicator quality-excellent"></i>',
                    good: '<i class="fas fa-thumbs-up quality-indicator quality-good"></i>',
                    fair: '<i class="fas fa-exclamation-triangle quality-indicator quality-fair"></i>'
                }[res.quality];

                const timeItem = document.createElement('div');
                timeItem.className = 'time-item';
                timeItem.innerHTML = `
                    ${qualityIcon}
                    <h4>${res.cycles} Cycles (${res.cycles * 1.5} hrs)</h4>
                    <p>${res.time}</p>
                `;
                container.appendChild(timeItem);
            });
        }

        // Age Recommendations
        const ageRecommendations = [
            { range: 'Newborn (0-3 months)', duration: '14-17 hours' },
            { range: 'Infant (4-11 months)', duration: '12-15 hours' },
            { range: 'Toddler (1-2 years)', duration: '11-14 hours' },
            { range: 'Preschool (3-5 years)', duration: '10-13 hours' },
            { range: 'School Age (6-13 years)', duration: '9-11 hours' },
            { range: 'Teen (14-17 years)', duration: '8-10 hours' },
            { range: 'Adult (18-64 years)', duration: '7-9 hours' },
            { range: 'Senior (65+ years)', duration: '7-8 hours' }
        ];

        document.querySelector('[data-tab="age"]').addEventListener('click', () => {
            const container = document.getElementById('age-recommendations');
            if (container) {
                container.innerHTML = ageRecommendations.map(age => `
                    <div class="age-card">
                        <h3>${age.range}</h3>
                        <p>${age.duration}</p>
                        <small>Recommended daily sleep</small>
                    </div>
                `).join('');
            }
        });

        // Sleep Quality Assessment
        let qualityScore = 0;
        const maxQualityScore = 15; // 3 questions × max 5 points each
        
        document.querySelectorAll('.quality-option').forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from siblings
                this.parentNode.querySelectorAll('.quality-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add selected class to clicked option
                this.classList.add('selected');
                
                // Recalculate score
                qualityScore = 0;
                document.querySelectorAll('.quality-option.selected').forEach(opt => {
                    qualityScore += parseInt(opt.dataset.value) || 0;
                });
                
                updateQualityResult();
            });
        });

        function updateQualityResult() {
            const resultDiv = document.querySelector('.quality-result');
            const scoreDiv = resultDiv.querySelector('.quality-score');
            
            scoreDiv.textContent = `${qualityScore}/${maxQualityScore}`;
            resultDiv.style.display = 'block';
            
            // Update recommendations based on score
            const recList = resultDiv.querySelector('.quality-recommendations ul');
            if (qualityScore >= 12) {
                recList.innerHTML = `
                    <li>Your sleep quality is excellent!</li>
                    <li>Keep up your good sleep habits</li>
                `;
            } else if (qualityScore >= 8) {
                recList.innerHTML = `
                    <li>Your sleep quality is good</li>
                    <li>Try to maintain consistent sleep times</li>
                    <li>Limit caffeine in the afternoon</li>
                `;
            } else {
                recList.innerHTML = `
                    <li>Your sleep needs improvement</li>
                    <li>Establish a regular sleep schedule</li>
                    <li>Create a relaxing bedtime routine</li>
                    <li>Avoid screens 1 hour before bed</li>
                    <li>Keep your bedroom cool and dark</li>
                `;
            }
        }
    });
    </script>
</body>
</html>
